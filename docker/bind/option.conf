options {
    directory "/var/cache/bind";
    listen-on port 53 { any; };
    listen-on-v6 { any; };

//    // DNS-over-TLS configuration for BIND 9.20
//    listen-on port 853 tls dot { any; };
//    tls-port 853;

    allow-query { any; };
    recursion no;

    // Enhanced DNSSEC for security
    dnssec-validation auto;
    dnssec-accept-expired no;

    // DNSSEC key management
    managed-keys-directory "/var/cache/bind/managed-keys";
    session-keyfile "/var/cache/bind/session.key";

    // Security settings
    version "unknown";
    hostname "unknown";
    server-id "unknown";

    // Rate limiting to prevent abuse
    rate-limit {
        responses-per-second 20;
        window 5;
        slip 2;
    };

    // Prevent amplification attacks
    max-udp-size 1232;
    edns-udp-size 1232;
    querylog yes;

    // Forward DNS
    forwarders {
      1.1.1.1;
      8.8.8.8;
    };
};

// TLS configuration for BIND 9.20
//tls dot {
//    cert-file "/etc/ssl/bind/cert.pem";
//    key-file "/etc/ssl/bind/key.pem";
//    protocols { TLSv1.2; TLSv1.3; };
//};
